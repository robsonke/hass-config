blueprint:
  name: Heating Control
  description: Control your heating with options if temp is below a specific value,
    set temp, and heating between specific times.
  domain: automation
  input:
    heating:
      name: Climate Switch
      description: The climate switch to use.
      selector:
        entity:
          domain: switch
    temp_sensor:
      name: Temperature Sensor
      description: Temperature Sensor to check.
      selector:
        entity:
          domain: sensor
          device_class: temperature
    min_temp:
      name: Minimum Temp
      description: If temperature is below this value it turns heating on.
      default: 15
      selector:
        number:
          min: 15.0
          max: 25.0
          step: 1.0
          mode: slider
    set_temp:
      name: Temperature Target
      description: If the heating turns on, it heats to this target temperature.
      default: 20
      selector:
        number:
          min: 15.0
          max: 25.0
          step: 1.0
          mode: slider
    time_after:
      name: Time After
      description: After this time the heating turns on, so it's warm in the morning
      default: 07:30:00
      selector:
        time: {}
    time_before:
      name: Time Before
      description: After this time the heating turns off, this to prevent the heating
        is on in the middle of the night
      default: '21:30:00'
      selector:
        time: {}
  source_url: https://gist.github.com/robsonke/850ca17a2ca3417601ae0f73d523cc34
variables:
  set_temp: !input 'set_temp'
trigger:
- platform: homeassistant
  event: start
- platform: event
  event_type: automation_reloaded
- platform: time_pattern
  minutes: /10
action:
- choose:
  - conditions:
    - condition: numeric_state
      entity_id: !input 'temp_sensor'
      below: !input 'min_temp'
    - condition: time
      before: !input 'time_before'
      after: !input 'time_after'
    sequence:
    - service: switch.turn_on
      data:
        entity_id: !input 'heating'
  default:
  - service: switch.turn_off
    data:
      entity_id: !input 'heating'
mode: single
