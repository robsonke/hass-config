action: fire-dom-event
browser_mod:
  command: popup
  large: true
  title: Steffi
  style:
    hui-vertical-stack-card:
      $hui-history-graph-card$ : |
        .content {
          padding: 0.2em 1.7em 1.2em 1.7em !important;
        }
      $: |
        button-card {
          align-self: center;
          padding: 0.2em 0 2.3em 0;
        }
      $hui-map-card:
        $: |
          #root {
            height: 100%;
            padding-bottom: 0 !important;
          }
          mwc-icon-button {
            color: var(--primary-color);
          }
          ha-card {
            border-radius: 0;
            animation: border 1s forwards;
          }
          @keyframes border {
            0%, 100% {
              border-top: 2px solid #1a1a1a;
            }
          }
        $ha-map$: |
          #map {
            background-color: #191919 !important;
          }
          .leaflet-control-attribution {
            display: none;
          }
          .leaflet-bar a {
            background-color: rgba(47, 51, 51, 0.9) !important;
            color: #9da0a2 !important;
          }
          a.leaflet-control-zoom-in {
            border-bottom: 1px solid #181818 !important;
          }
          .leaflet-pane.leaflet-tile-pane {
            filter: contrast(85%);
          }
  card:
    type: custom:layout-card
    layout_type: custom:grid-layout
    layout:
      grid-template-columns: 50% 50%
      grid-template-rows: auto
      grid-template-areas: |
        "presence map"
      mediaquery:
        "(max-width: 800px)":
          grid-template-columns: auto
          grid-template-rows: auto
          grid-template-areas: |
            "presence"
            "map"
    cards:
      - type: vertical-stack
        view_layout:
          grid-area: presence
        cards:
          - type: entities
            card_mod:
              class: content
            entities:
              - entity: person.steffi
                secondary_info: last-changed
          - type: history-graph
            entities:
              - entity: person.steffi
          - type: history-graph
            title: Presence Graphs Steffi
            hours_to_show: 12
            refresh_interval: 30
            entities:
              - device_tracker.steffi_presence
              - device_tracker.iphone_steffi
              - device_tracker.life360_steffi_berks
              - device_tracker.iphonedetect_steffi
          - type: glance
            show_state: false
            entities:
              - entity: device_tracker.iphonedetect_steffi
                name: Router
                icon: mdi:wifi
                style: &state |
                  state-badge {
                    color: {{ '#3182b7' if is_state(config.entity, 'home') else '#3c3f3f' }};
                  }
              - entity: device_tracker.life360_steffi_berks
                name: Life360
                icon: mdi:account
                style: *state
              - entity: device_tracker.iphone_steffi
                name: GPS
                icon: mdi:cellphone
                style: *state

      - type: map
        default_zoom: 16
        dark_mode: true
        entities:
          - device_tracker.steffi_presence
        view_layout:
          grid-area: map