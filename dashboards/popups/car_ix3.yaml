action: fire-dom-event
browser_mod:
  command: popup
  large: true
  title: BMW iX3
  card:
    type: custom:layout-card
    layout_type: custom:grid-layout
    layout:
      grid-template-columns: 50% 50%
      grid-template-rows: auto
      grid-template-areas: |
        "details map"
      mediaquery:
        "(max-width: 800px)":
          grid-template-columns: auto
          grid-template-rows: auto
          grid-template-areas: |
            "details"
            "map"
    cards:
      - type: vertical-stack
        view_layout:
          grid-area: details
        cards:
          - type: picture-elements
            image: /local/images/bmwix3_icon.png
            elements:
              - type: state-icon
                entity: binary_sensor.ix3_door_lock_state
                tap_action: more-info
                hold_action:
                  action: call-service
                  service: lock.lock
                  target:
                    entity_id: lock.ix3_lock
                style:
                  top: 88.5%
                  left: 10%
                  # '--paper-item-icon-color': white
              - type: state-label
                entity: binary_sensor.ix3_door_lock_state
                style:
                  top: 95.5%
                  left: 10%
                  font-size: 0.8em
                  # color: white
              - type: state-icon
                entity: binary_sensor.ix3_windows
                tap_action: more-info
                style:
                  top: 88.5%
                  left: 20%
                  # '--paper-item-icon-color': white
              - type: state-label
                entity: binary_sensor.ix3_windows
                style:
                  top: 95.5%
                  left: 20%
                  font-size: 0.8em
                  # color: white
              - type: state-icon
                entity: binary_sensor.ix3_lids
                tap_action: more-info
                style:
                  top: 88.5%
                  left: 30%
                  # '--paper-item-icon-color': white
              - type: state-label
                entity: binary_sensor.ix3_lids
                style:
                  top: 95.5%
                  left: 30%
                  font-size: 0.8em
                  # color: white
              - type: state-icon
                entity: sensor.ix3_mileage
                tap_action: more-info
                style:
                  top: 88.5%
                  left: 40%
                  # '--paper-item-icon-color': white
              - type: state-label
                entity: sensor.ix3_mileage
                style:
                  top: 95.5%
                  left: 40%
                  font-size: 0.8em
                  # color: white
              - type: state-icon
                entity: binary_sensor.ix3_condition_based_services
                tap_action: more-info
                style:
                  top: 88.5%
                  left: 50%
                  # '--paper-item-icon-color': white
              - type: state-label
                entity: binary_sensor.ix3_condition_based_services
                style:
                  top: 95.5%
                  left: 50%
                  font-size: 0.8em
                  # color: white
              - type: conditional
                conditions:
                  - entity: binary_sensor.ix3_connection_status
                    state: 'on'
                elements:
                  - type: state-icon
                    entity: binary_sensor.ix3_connection_status
                    tap_action: more-info
                    icon: mdi:ev-plug-type2
                    style:
                      top: 88.5%
                      left: 60%
                      # '--paper-item-icon-color': white
                  - type: custom:text-element
                    text: Plugged
                    style:
                      top: 95.5%
                      left: 60%
                      font-size: 0.8em
                      # color: white
              - type: conditional
                conditions:
                  - entity: binary_sensor.ix3_charging_status
                    state: 'on'
                elements:
                  - type: state-label
                    entity: sensor.ix3_charging_end_time
                    prefix: ''
                    style:
                      top: 93.5%
                      right: '-5%'
                      font-size: 0.8em
                      # color: white
              - type: custom:circle-sensor-card
                entity: sensor.ix3_charging_level_hv
                max: 100
                min: 0
                stroke_width: 15
                gradient: true
                fill: rgba(54, 65, 78, 0.6)
                name: Level
                units: '%'
                font_style:
                  font-size: 0.9em
                  color: white
                color_stops:
                  '5': '#09C7E8'
                  '63': '#09A50C'
                style:
                  top: 6%
                  left: 5%
                  width: 4em
                  height: 4em
                  transform: none
              - type: custom:circle-sensor-card
                entity: sensor.ix3_remaining_range_electric
                max: 370
                min: 0
                stroke_width: 15
                gradient: true
                fill: rgba(54, 65, 78, 0.6)
                name: Bereik
                units: km
                font_style:
                  font-size: 0.9em
                  color: white
                color_stops:
                  '100': '#09C7E8'
                  '300': '#09A50C'
                style:
                  top: 6%
                  right: 5%
                  width: 4em
                  height: 4em
                  transform: none
          - type: history-graph
            title: BMW iX3
            hours_to_show: 12
            refresh_interval: 30
            entities:
              - device_tracker.ix3
          - type: entities
            card_mod:
              class: content
            entities:
              - entity: device_tracker.ix3
                secondary_info: last-changed
      - type: map
        default_zoom: 13
        dark_mode: true
        hours_to_show: 24
        entities:
          - person.bmw_ix3
        view_layout:
          grid-area: map
